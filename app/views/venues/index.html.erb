

<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCsrce8xS9a6NSyqRQBhP-TmGBQGSCL_aE&sensor=true"></script>

<div id="map-container">
  <div id="map-canvas" ></div>
</div>


<script type="text/javascript">
function initialize() {
  var myLatLng = new google.maps.LatLng(<%= @venues.last.lat%>, <%=@venues.last.lng%>); // we set this as a var because we're going to reuse it for center/marker position -- you can elect to create separate google.maps.LatLng objects

  var mapOptions = {
    center: myLatLng, // see above
    zoom: 16 // arbitrary; you can zoom at whichever level you like
  };
  var map = new google.maps.Map(document.getElementById("map-canvas"),
      mapOptions); // rendering a map in a div with the id of "map-canvas" and the options specified above in mapOptions

  getVenues(); // calls getSpots function

  function getVenues() {  // GETs all Venues spots from the JSON API

    $.ajax ({
      type: "GET", 
      dataType: "json", 
      url: "http://localhost:3000/venues.json"   // this is our own JSON from jbuilder!         
    }).done(function(data){
        mapVenues(data);// calling the mapSpots function on this data
    });
  }



  var iconMarker = {
    url:'assets/Map_Icon.png',
    scaledSize: new google.maps.Size(32,32),
    size: new google.maps.Size(64, 64)

  };

  var showMeMarker = new google.maps.Marker({
    position: myLatLng,
    map: map,
    icon: iconMarker
  });

  function mapVenues(venue_data) {

    // for loop to place each marker with info from the JSON

    var i, newMarker;

    for (i=0; i < venue_data.length; i++) {
      newMarker = new google.maps.Marker({
        position: new google.maps.LatLng(venue_data[i].lat, venue_data[i].lng), // sets the LatLng of each spot
        map: map, 
        title: (venue_data[i].name),
        icon: iconMarker
      });
    };
  }

}

google.maps.event.addDomListener(window, 'load', initialize);


</script>